# This file is part of osint.py program
# @lymbin 2021-2022

import os

github_exploits_name = 'github_exploits'

github_exploits_git_path = 'https://github.com/nomi-sec/PoC-in-GitHub.git'

class GithubExploitsUpdater:
    def update(packages_folder):
        GithubExploitsUpdater.init(packages_folder)
        
    def init(packages_folder):
        try:
            if not os.path.exists(os.path.join(packages_folder, github_exploits_name)):
                print ("Init github PoCs repo with latest exploits")
                os.system("cd %s; git clone %s %s" % (packages_folder, github_exploits_git_path, github_exploits_name))
            else:
                print ("Refreshing github PoCs repo with latest exploits")
                os.system("cd %s; git pull origin master" % os.path.join(packages_folder, github_exploits_name))
        except Exception as e:
            print('Failed to init. Reason: %s' % e)

