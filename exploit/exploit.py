# This file is part of osint.py program
# @lymbin 2021-2022

import os

from .exploitdb import ExploitDB
from .github_exploits import GithubExploits

"""
-- 0.1 --
Initial release

"""
version = '0.1'


class Exploit:
    """
    Exploit module using for search exploits
    Uses ExploitDB and Github modules
    ExploitDB is a database of exlploits from https://www.exploit-db.com
    Github exploit database is hosted on https://github.com/nomi-sec/PoC-in-GitHub/
    """

    def __init__(self, packages_folder: str = os.path.dirname(os.path.realpath(__file__))):
        self.engines = {
            'All': 'All',
            'Github': GithubExploits,
            'ExploitDB': ExploitDB
        }
        self.exploitdb = ExploitDB(packages_folder)
                
    def search(self, cve, mode: str = 'ExploitDB'):
        print('Using %s exploits database' % mode)
        if mode == 'All':
            print('Not implemented yet')
        print(self.exploitdb.search_cve(cve))
        
    def search_from_file(self, file):
        print(self.exploitdb.search_from_file(file))

    @staticmethod
    def update():
        ExploitDB.update(os.path.dirname(os.path.realpath(__file__)))
        GithubExploits.update(os.path.dirname(os.path.realpath(__file__)))

    @staticmethod
    def init():
        ExploitDB.init(os.path.dirname(os.path.realpath(__file__)))
        GithubExploits.init(os.path.dirname(os.path.realpath(__file__)))

    @staticmethod
    def clear():
        pass
